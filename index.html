<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZOMBIE PIXEL — Full Website + Admin Panel (FamPay QR Secured)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f1a20;--panel:#17242e;--card:#0f1a20;--accent:#00c6ff;--accent2:#0072ff;--grad:linear-gradient(90deg,var(--accent),var(--accent2));--text:#e8f1f7;--muted:#a9bdc9;--danger:#ff3860;--success:#06d6a0}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(135deg,#0f1a20 0%,#1a2c38 100%);color:var(--text);font-family:Rubik,system-ui,-apple-system,Segoe UI,Arial,sans-serif}
    a{color:var(--text)}
    .pixel{font-family:'Press Start 2P',cursive}

    /* Header */
    header{position:sticky;top:0;z-index:1000;background:rgba(15,26,32,.9);backdrop-filter:blur(6px);border-bottom:2px solid var(--accent)}
    .container{width:92%;max-width:1200px;margin:0 auto}
    .header-inner{display:flex;align-items:center;justify-content:space-between;padding:.9rem 0}
    .logo{display:flex;align-items:center;gap:.7rem}
    .logo img{height:42px;width:42px;border-radius:8px}
    nav ul{list-style:none;display:flex;gap:1.1rem;margin:0;padding:0}
    nav a{text-decoration:none;color:var(--text)}

    /* Buttons */
    .btn{display:inline-flex;align-items:center;gap:.5rem;background:var(--grad);border:none;color:#001018;padding:.8rem 1.1rem;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 8px 28px rgba(0,198,255,.25);transition:.2s;text-decoration:none}
    .btn:hover{transform:translateY(-2px)}
    .btn.small{padding:.55rem .8rem;border-radius:10px}
    .btn.ghost{background:transparent;border:2px solid var(--accent);color:var(--text)}
    .btn.danger{background:linear-gradient(90deg,#ff4d6d,#ff2b56);color:#fff}
    .btn[disabled]{opacity:.55;cursor:not-allowed;filter:grayscale(40%)}

    /* Hero */
    .hero{min-height:72vh;display:grid;place-items:center;background:url('https://i.imgur.com/3RX3GQp.png') center/cover no-repeat;position:relative}
    .hero::before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,rgba(15,26,32,.78),rgba(0,114,255,.35))}
    .hero-inner{position:relative;z-index:1;text-align:center;padding:2rem}
    .hero .ip{display:inline-flex;align-items:center;gap:.6rem;border:2px solid var(--accent);padding:.7rem 1rem;border-radius:12px;background:rgba(0,0,0,.35)}

    section{padding:3.2rem 0}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:1rem}
    .card{background:rgba(0,0,0,.28);border:2px solid var(--accent);border-radius:14px;padding:1rem}

    /* Ranks */
    .ranks-wrap{max-width:900px;margin:0 auto;border:2px solid var(--accent);border-radius:14px;background:rgba(0,0,0,.25)}
    .rank-row{display:grid;grid-template-columns:1fr auto auto;align-items:center;gap:.8rem;padding:1rem;border-bottom:1px solid rgba(255,255,255,.12)}
    .rank-row:last-child{border-bottom:none}
    .rank-title{display:flex;align-items:center;gap:.7rem;color:var(--accent);font-weight:800}
    .rank-title img{height:28px;width:28px;border-radius:50%}

    /* Modal */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px);z-index:2000}
    .modal .content{background:linear-gradient(135deg,#0f1a20,#1a2c38);border:2px solid var(--accent);border-radius:16px;max-width:560px;width:92%;margin:6% auto;padding:1.2rem;position:relative}
    .close{position:absolute;right:12px;top:8px;font-size:26px;cursor:pointer;color:#a7bac6}
    .close:hover{color:#fff}
    .field{margin:.8rem 0}
    .field label{display:block;margin-bottom:.35rem;color:var(--accent);font-weight:700}
    .field input,.field select{width:100%;padding:.7rem;border-radius:10px;border:2px solid var(--accent);background:rgba(0,0,0,.28);color:#fff}
    .qrbox{margin:.7rem auto 0;max-width:220px;background:#fff;padding:10px;border-radius:10px;border:2px solid var(--accent)}
    .note{opacity:.85}

    /* Admin */
    .admin-toggle{position:fixed;right:18px;bottom:18px}
    .panel{display:none;background:rgba(15,26,32,.95);border:2px solid var(--accent);border-radius:16px;margin:2rem auto;max-width:1200px;padding:1rem}
    .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:.8rem}
    .stat{background:rgba(0,0,0,.28);border:2px solid var(--accent);border-radius:12px;padding:1rem;text-align:center}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.6rem;border-bottom:1px solid rgba(255,255,255,.12);text-align:left}
    th{color:var(--accent);background:rgba(0,0,0,.25)}

    footer{border-top:2px solid var(--accent);text-align:center;padding:1.6rem 0;background:#0f1a20}
  </style>
</head>
<body>

<header>
  <div class="container header-inner">
    <div class="logo">
      <img src="https://i.imgur.com/Z3zG6jK.png" alt="Logo"/>
      <h1 class="pixel" style="color:var(--accent)">ZOMBIE PIXEL</h1>
    </div>
    <nav>
      <ul>
        <li><a href="#features">Features</a></li>
        <li><a href="#ranks">Ranks</a></li>
        <li><a href="#rules">Rules</a></li>
        <li><a href="#join">Join</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="hero" id="home">
  <div class="hero-inner">
    <h2 class="pixel" style="color:var(--accent);font-size:2.4rem">ZOMBIE PIXEL SMP</h2>
    <p style="margin:.4rem 0 1rem">Minecraft Survival • 1.19.2</p>
    <div class="ip pixel">play.zombiepixel.fun</div>
    <div style="margin-top:12px"><a class="btn" id="copyIp"><i class="fas fa-copy"></i> Copy IP</a></div>
  </div>
</section>

<section id="features">
  <div class="container">
    <h2 class="pixel" style="color:var(--accent);text-align:center">Server Features</h2>
    <div class="grid" style="margin-top:1rem">
      <div class="card"><i class="fas fa-shield-alt"></i> <h3>Anti‑Cheat</h3><p>Fair play, 24/7 moderation.</p></div>
      <div class="card"><i class="fas fa-bolt"></i> <h3>Low Lag</h3><p>Optimized hardware & configs.</p></div>
      <div class="card"><i class="fas fa-users"></i> <h3>Community</h3><p>Events & active Discord.</p></div>
      <div class="card"><i class="fas fa-sync-alt"></i> <h3>Updates</h3><p>New content regularly.</p></div>
    </div>
  </div>
</section>

<section id="ranks">
  <div class="container">
    <h2 class="pixel" style="color:var(--accent);text-align:center">Ranks For Sale</h2>
    <div id="ranksList" class="ranks-wrap"></div>
  </div>
</section>

<section id="rules">
  <div class="container">
    <h2 class="pixel" style="color:var(--accent);text-align:center">Server Rules</h2>
    <ul style="line-height:1.8;max-width:840px;margin:1rem auto;font-size:1rem">
      <li>Be respectful to all players and staff.</li>
      <li>No hacking, x‑ray, dupes, or exploiting bugs.</li>
      <li>Do not grief or steal; claim your builds.</li>
      <li>No spamming or advertising other servers.</li>
      <li>Keep chat PG‑friendly; avoid toxicity.</li>
      <li>Follow staff instructions at all times.</li>
    </ul>
  </div>
</section>

<section id="join">
  <div class="container">
    <h2 class="pixel" style="color:var(--accent);text-align:center">How to Join</h2>
    <div class="grid" style="margin-top:1rem">
      <div class="card"><i class="fas fa-clipboard-list"></i><h3>Step 1</h3><p>Read the rules carefully.</p></div>
      <div class="card"><i class="fas fa-gamepad"></i><h3>Step 2</h3><p>Open Minecraft & add server IP.</p></div>
      <div class="card"><i class="fas fa-sign-in-alt"></i><h3>Step 3</h3><p>Join & start playing!</p></div>
    </div>
  </div>
</section>

<!-- Purchase Modal (FamPay) -->
<div id="purchaseModal" class="modal">
  <div class="content">
    <span class="close" onclick="closePurchase()">&times;</span>
    <h2 class="pixel">Purchase Rank</h2>
    <div class="field"><label>IGN</label><input id="ign" placeholder="Your Minecraft username"></div>
    <div class="field"><label>Payment Method</label>
      <select id="payMethod"><option value="UPI">UPI (FamPay / GPay / PhonePe)</option></select>
    </div>
    <div class="field" style="text-align:center">
      <div><strong>Selected:</strong> <span id="selRank">-</span></div>
      <div style="margin-top:4px"><strong>Price:</strong> ₹<span id="selPrice">0</span></div>
      <div class="qrbox"><img id="qrImg" alt="UPI QR" /></div>
      <a id="payNow" class="btn" style="margin-top:8px;display:inline-block" target="_blank"><i class="fas fa-wallet"></i> Pay Now</a>
      <div class="note" style="margin-top:6px;font-size:.9rem">Scan / tap to pay the exact amount. After paying, enter the <b>UTR</b> below and confirm.</div>
    </div>
    <div class="field"><label>UPI Reference (UTR)</label><input id="utr" placeholder="Example: 3129XXXXXX" maxlength="24"></div>
    <button id="confirmBtn" class="btn" onclick="confirmPaid()" disabled>I’ve made the payment</button>
  </div>
</div>

<!-- Admin Login Modal -->
<div id="loginModal" class="modal">
  <div class="content">
    <span class="close" onclick="closeLogin()">&times;</span>
    <h2 class="pixel">Admin Login</h2>
    <div class="field"><label>Username</label><input id="admU" placeholder="Admin username"></div>
    <div class="field"><label>Password</label><input id="admP" type="password" placeholder="Password"></div>
    <button class="btn" onclick="adminLogin()">Login</button>
    <div id="loginErr" style="color:var(--danger);display:none;margin-top:6px">Invalid credentials</div>
  </div>
</div>

<!-- Admin Panel -->
<div id="adminPanel" class="panel">
  <h2 class="pixel">Admin Panel</h2>
  <div class="stats">
    <div class="stat"><h3>Total Purchases</h3><div id="statPurch">0</div></div>
    <div class="stat"><h3>Total Revenue</h3>₹<span id="statRev">0</span></div>
    <div class="stat"><h3>Popular Rank</h3><span id="statBest">-</span></div>
  </div>

  <div style="display:flex;gap:.6rem;align-items:center;margin-top:1rem">
    <label><input type="checkbox" id="filterCompleted"> Show only <b>Completed</b></label>
    <button class="btn ghost small" onclick="exportCSV()"><i class="fas fa-file-export"></i> Export CSV</button>
  </div>

  <h3 style="margin-top:1rem;color:var(--accent)">Purchase History</h3>
  <div style="overflow:auto">
    <table>
      <thead><tr><th>Date</th><th>IGN</th><th>Rank</th><th>Price</th><th>Status</th><th>UTR</th><th>Actions</th></tr></thead>
      <tbody id="pTable"></tbody>
    </table>
  </div>

  <h3 style="margin-top:1rem;color:var(--accent)">Manage Prices</h3>
  <div class="grid">
    <div class="card">GOD ₹<input id="pGOD" type="number" min="0" style="width:100%;margin-top:.4rem"></div>
    <div class="card">SAVAGE ₹<input id="pSAV" type="number" min="0" style="width:100%;margin-top:.4rem"></div>
    <div class="card">WARRIOR ₹<input id="pWAR" type="number" min="0" style="width:100%;margin-top:.4rem"></div>
    <div class="card">KNIGHT ₹<input id="pKNI" type="number" min="0" style="width:100%;margin-top:.4rem"></div>
    <div class="card">ROOKIE ₹<input id="pROO" type="number" min="0" style="width:100%;margin-top:.4rem"></div>
  </div>
  <div style="margin-top:.6rem"><button class="btn" onclick="savePrices()">Save Prices</button> <button class="btn danger" onclick="adminLogout()">Logout</button></div>
</div>

<button class="btn admin-toggle" onclick="openLogin()"><i class="fas fa-user-shield"></i> Admin</button>

<footer>
  <div class="container"><span class="pixel">© <span id="yr"></span> ZOMBIE PIXEL</span></div>
</footer>

<script>
  // ===== CONFIG =====
  const UPI_ID = '9149977246@fam'; // Your FamPay UPI ID
  const DEFAULT_PRICES = { GOD:1000, SAVAGE:500, WARRIOR:200, KNIGHT:100, ROOKIE:50 };
  const RANKS = ['GOD','SAVAGE','WARRIOR','KNIGHT','ROOKIE'];
  const RANK_LOGOS = {
    GOD: 'https://i.imgur.com/Cv2YQFJ.png',
    SAVAGE: 'https://i.imgur.com/ZFg5bGo.png',
    WARRIOR:'https://i.imgur.com/7D7Ww6m.png',
    KNIGHT: 'https://i.imgur.com/YWjM7pq.png',
    ROOKIE: 'https://i.imgur.com/vuRjYfk.png'
  };
  // Strong default admin credentials (change if you want)
  let adminCreds = { username:'spectral_root_9FZ7', password:'Qx!9uK$3cPzR7@Lm4^vN1#tWb*Ay' };

  // ===== HELPERS =====
  const $ = id=>document.getElementById(id);
  const prices = ()=> JSON.parse(localStorage.getItem('rankPrices')||'null') || {...DEFAULT_PRICES};
  const setPrices = p=> localStorage.setItem('rankPrices', JSON.stringify(p));
  const fmt = n=> n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');

  // ===== RANK LIST =====
  function renderRanks(){
    const p = prices();
    const box = $('ranksList'); box.innerHTML='';
    RANKS.forEach(r=>{
      const row = document.createElement('div'); row.className='rank-row';
      row.innerHTML = `<div class="rank-title"><img src="${RANK_LOGOS[r]}" alt="${r}">${r}</div><div>₹${p[r]}</div><div><button class="btn small" onclick="openPurchase('${r}', ${p[r]})">Buy Now</button></div>`;
      box.appendChild(row);
    });
  }

  // ===== PURCHASE FLOW (Front-end gating) =====
  let upiOpened=false, pageHidden=false;
  document.addEventListener('visibilitychange',()=>{ if(document.hidden) pageHidden=true; });

  function openPurchase(rank, price){
    $('selRank').textContent = rank; $('selPrice').textContent = price;
    $('ign').value=''; $('utr').value='';
    upiOpened=false; pageHidden=false; $('confirmBtn').disabled = true;
    const upiLink = `upi://pay?pa=${encodeURIComponent(UPI_ID)}&pn=${encodeURIComponent('ZombiePixel')}&am=${encodeURIComponent(price)}&cu=INR`;
    $('qrImg').src = `https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(upiLink)}`;
    const pay = $('payNow'); pay.href = upiLink; pay.onclick = ()=>{ upiOpened=true; setTimeout(()=> enableIfEligible(), 500); };
    $('purchaseModal').style.display='block';
  }
  function enableIfEligible(){ $('confirmBtn').disabled = !(upiOpened && pageHidden); }
  function closePurchase(){ $('purchaseModal').style.display='none'; }

  function confirmPaid(){
    const ign = $('ign').value.trim();
    const rank = $('selRank').textContent; const price = +$('selPrice').textContent;
    const utr = $('utr').value.trim();
    if(!ign){ alert('Enter your IGN'); return; }
    if(!upiOpened || !pageHidden){ alert('Please tap Pay Now and complete payment in your UPI app.'); return; }
    if(utr.length < 6){ alert('Enter the UPI reference (UTR) from your payment.'); return; }
    // Save as Pending (admin verifies later). Unpaid entries never saved due to gating above.
    const arr = JSON.parse(localStorage.getItem('purchases')||'[]');
    arr.push({date:new Date().toISOString(), username:ign, rank, price, status:'Pending', utr});
    localStorage.setItem('purchases', JSON.stringify(arr));
    alert('Thanks! Your payment is marked Pending. Staff will verify and approve.');
    closePurchase(); updateStats(); renderPurchases();
  }

  // ===== ADMIN =====
  function openLogin(){ $('loginModal').style.display='block'; }
  function closeLogin(){ $('loginModal').style.display='none'; $('loginErr').style.display='none'; }
  let logged=false;
  function adminLogin(){ const u=$('admU').value, p=$('admP').value; if(u===adminCreds.username && p===adminCreds.password){ logged=true; closeLogin(); $('adminPanel').style.display='block'; fillPriceInputs(); renderPurchases(); updateStats(); } else { $('loginErr').style.display='block'; } }
  function adminLogout(){ logged=false; $('adminPanel').style.display='none'; alert('Logged out'); }

  function renderPurchases(){ if(!logged) return; const tb=$('pTable'); tb.innerHTML=''; const arr = JSON.parse(localStorage.getItem('purchases')||'[]');
    const onlyCompleted = $('filterCompleted').checked;
    (onlyCompleted?arr.filter(p=>p.status==='Completed'):arr).forEach(p=>{
      const tr=document.createElement('tr');
      tr.innerHTML = `<td>${new Date(p.date).toLocaleString()}</td><td>${p.username}</td><td>${p.rank}</td><td>₹${p.price}</td><td><select onchange="setStatus('${p.date}', this.value)"><option ${p.status==='Pending'?'selected':''}>Pending</option><option ${p.status==='Completed'?'selected':''}>Completed</option><option ${p.status==='Refunded'?'selected':''}>Refunded</option></select></td><td>${p.utr||''}</td><td><button class='btn danger small' onclick="delPurchase('${p.date}')">Delete</button></td>`;
      tb.appendChild(tr);
    });
  }
  function setStatus(dateStr, st){ const arr = JSON.parse(localStorage.getItem('purchases')||'[]'); const i = arr.findIndex(x=>x.date===dateStr); if(i>-1){ arr[i].status=st; localStorage.setItem('purchases', JSON.stringify(arr)); updateStats(); }}
  function delPurchase(dateStr){ const arr = JSON.parse(localStorage.getItem('purchases')||'[]'); const next = arr.filter(x=>x.date!==dateStr); localStorage.setItem('purchases', JSON.stringify(next)); renderPurchases(); updateStats(); }

  function updateStats(){ const arr = JSON.parse(localStorage.getItem('purchases')||'[]'); $('statPurch').textContent = arr.length; const rev = arr.filter(p=>p.status==='Completed').reduce((s,p)=>s+p.price,0); $('statRev').textContent = fmt(rev); const counts={}; arr.forEach(p=>counts[p.rank]=(counts[p.rank]||0)+1); let best='-'; let mx=0; for(const [k,v] of Object.entries(counts)){ if(v>mx){mx=v;best=k;} } $('statBest').textContent = best; }

  function fillPriceInputs(){ const p=prices(); $('pGOD').value=p.GOD; $('pSAV').value=p.SAVAGE; $('pWAR').value=p.WARRIOR; $('pKNI').value=p.KNIGHT; $('pROO').value=p.ROOKIE; }
  function savePrices(){ const p={ GOD:+$('pGOD').value||0, SAVAGE:+$('pSAV').value||0, WARRIOR:+$('pWAR').value||0, KNIGHT:+$('pKNI').value||0, ROOKIE:+$('pROO').value||0 }; setPrices(p); renderRanks(); alert('Prices updated'); }

  function exportCSV(){ const arr = JSON.parse(localStorage.getItem('purchases')||'[]'); if(!arr.length){ alert('No data'); return; } const header=['date','username','rank','price','status','utr']; const rows = [header.join(','), ...arr.map(o=> header.map(k=>`"${(o[k]??'').toString().replace(/"/g,'""')}"`).join(','))]; const blob = new Blob([rows.join('\n')], {type:'text/csv'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='purchases.csv'; a.click(); URL.revokeObjectURL(url); }

  // ===== INIT =====
  $('yr').textContent = new Date().getFullYear();
  if(!localStorage.getItem('rankPrices')) setPrices({...DEFAULT_PRICES});
  renderRanks();
  $('copyIp').onclick = (e)=>{ e.preventDefault(); navigator.clipboard.writeText('play.zombiepixel.fun'); e.currentTarget.innerHTML='<i class="fas fa-check"></i> Copied!'; setTimeout(()=> e.currentTarget.innerHTML='<i class="fas fa-copy"></i> Copy IP', 1200); };
  $('filterCompleted').addEventListener('change', renderPurchases);
  window.addEventListener('click',e=>{ if(e.target===$('purchaseModal')) closePurchase(); if(e.target===$('loginModal')) closeLogin(); });
</script>
</body>
</html>
